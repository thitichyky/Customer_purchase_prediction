# -*- coding: utf-8 -*-
"""App.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1bvtyIfABn4Q91UHdbHXwBLIKdsbGByaW
"""

import gradio as gr
import pandas as pd
import joblib
from sklearn.preprocessing import LabelEncoder

model = joblib.load('purchase_prediction_model.joblib')
unique_values = joblib.load('unique_values.joblib')
group_values = unique_values['Group']
customer_segment_values = unique_values['Customer_Segment']

label_encoder = joblib.load('label_encoder.joblib')
def predict(group, customer_segment, sales_before, sales_after, satisfaction_before, satisfaction_after):
    input_data = pd.DataFrame({
        'Group': [group],
        'Customer_Segment': [customer_segment],
        'Sales_Before': [float(sales_before)],
        'Sales_After': [float(sales_after)],
        'Customer_Satisfaction_Before': [float(satisfaction_before)],
        'Customer_Satisfaction_After': [float(satisfaction_after)]
    })

    prediction = model.predict(input_data)

    prediction_label = label_encoder.inverse_transform(prediction)
    return str(prediction_label[0])

interface = gr.Interface(
    fn=predict,
    inputs=[
        gr.Dropdown(choices=list(group_values), label="Group"),
        gr.Dropdown(choices=list(customer_segment_values), label="Customer Segment"),
        gr.Number(label="Sales Before"),
        gr.Number(label="Sales After"),
        gr.Number(label="Customer Satisfaction Before(%)"),
        gr.Number(label="Customer Satisfaction After(%)")
    ],
    outputs=gr.Textbox(label="Prediction Result"),
    title="Customer Purchase Prediction",
    description="Enter customer details to predict whether a purchase was made."
)
interface.launch()
